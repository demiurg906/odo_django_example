# Проект с примером сервера на django

## Структура проекта

Все полезные файлы находятся в папке [odo_django_example](odo_django_example) (так же и называется сам проект).

#### urls.py

В этом файле находятся правила, по которым django определяет, какую вашу функцию вызывать при переходе на какую-нибудь страницу.

#### views.py

Здесь вы описываете функции, которые должны обрабатывать запрос на какую-нибудь страницу.

#### models.py

Здесь вы описываете все модели (сущности, которые хранятся в базе данных), с которыми хотите работать.

#### admin.py

Здесь вы настраиваете, какими моделями можно управлять через интерфейс администратора.

#### settings.py

Здесь описаны настройки вашего сервера. Не забудьте [добавить](odo_django_example/settings.py#L34) ваш проект в список установленных.

#### Папка templates

Здесь находятся шаблоны всех ваших _html_ страниц, которые вы хотите отправлять пользователям.

## Команды для работы с базой данных

#### Как добавить новые модели в базу данных:

```
python manage.py makemigrations odo_django_example
python manage.py migrate
```

#### Как создать нового суперпользователя

```
python manage.py createsuperuser
```

От вас потребуется ввести имя пользователя, электоронную почту (любую) и пароль. Пароль при вводе не будет отображаться, но это нормально, на самом деле вы его печатаете.

## Как рабоать с пользователями

Если вы хотите создать `view` для какой-либо работы с пользователями, то вам пригодятся следующие методы:

```python
from django.contrib.auth import authenticate, login, logout
from django.contrib.auth.models import User

def login_view(request):
    # текущий пользователь
    current_user = request.user
    
    # получили откуда-нибудь (из формы, например)
    username, password = ...     
    # найти подходящего пользователя в базе данных
    user = authenticate(request, username=username, password=password)
    
    if user is not None:
        # если такой пользователь есть, то залогинить
        login(request, user)
        ... # перенаправить на какую-нибудь странцу
    else:
        # подходящего пользователя нет
        ... # отправить страницу с ошибкой
        

def logout_view(request):
    # разлогинить пользователя
    logout(request)


def register_view(request):
    # получили откуда-нибудь (из формы, например)
    username, password, email = ...
    # создали нового юзера
    user = User.objects.create_user(username, email, password)
    # сохранили нового юзера в базу данных
    user.save()
    
    # после этого его можно залогинить и перенаправить куда-нибудь
```